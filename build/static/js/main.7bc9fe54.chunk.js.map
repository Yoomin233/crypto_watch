{"version":3,"sources":["components/Spinner.tsx","context/index.tsx","utils/number.ts","Cell/styled.ts","components/modal.tsx","Cell/index.tsx","Footer.tsx","Add.tsx","hooks/useGetListings.ts","hooks/useGetMapStorage.ts","hooks/useSubsequentUpdate.ts","hooks/useDebounce.ts","hooks/usePageFocus.ts","hooks/useWebSocket.ts","Info.tsx","utils/dom.ts","saveList.tsx","App.tsx","reportWebVitals.ts","index.tsx","components/useUpdateData.ts","utils/eventEmitter.ts"],"names":["spin","keyframes","SpinnerWrapper","styled","span","Spinner","GlobalContext","React","createContext","period","setPeriod","GlobalContextProvider","children","useState","Provider","value","removeTrailingZeros","num","String","replace","priceFormatter","price","toFixed","Math","max","floor","log10","count","determineFraction","Wrapper","div","CellWrapper","MoreSection","ChartsWrapper","Modal","show","onClose","createPortal","onClick","e","stopPropagation","document","body","LazyChart","lazy","ChartsGroup","memo","id","crypto","globalPeriod","setGlobalPeriod","useContext","useEffect","style","marginBottom","textAlign","fontWeight","className","undefined","Charts","fallback","PriceCell","name","info","onRemove","prices","setPrices","idx","expandStatus","setExpandStatus","edit","p24h","slug","symbol","amount","propsAmount","lastPrice","useRef","isUp","setIsUp","setAmount","current","setTimeout","onMove","idxOffset","temp","isExpanded","priceDisplay","useMemo","onInput","newAmount","Number","target","elementIndex","findIndex","token","href","rel","src","alt","placeholder","type","onChange","onKeyDown","key","disabled","length","backgroundColor","sqrt","abs","p","Footer","wsStatus","lastRefetch","reconnect","status","statusString","Date","TokenList","Result","AddBtn","AddToken","onAdd","mapData","search","setSearch","mapArr","Object","values","ref","open","setOpen","searchRes","filter","toLowerCase","includes","focus","padding","slice","map","r","useGetListings","ids","setter","setLastRefetch","refetch","axios","get","APIHost","join","then","data","priceData","cryptoCurrencyList","d","find","quotes","percentChange24h","useGetMapStorage","setMapData","localStorage","getItem","JSON","parse","fetchMap","useCallback","storedData","cryptoCurrencyMap","reduce","prev","next","setItem","stringify","timeStamp","console","log","useSubsequentUpdate","cb","deps","mounted","useDebounce","delay","debouncedValue","setDebouncedValue","handler","clearTimeout","usePageFocus","callback","isFocused","setIsFocused","hasFocus","handleFocusChange","currentFocus","window","addEventListener","removeEventListener","useWbSocket","onMessage","setWSStatus","WSInstance","debouncedIds","split","Boolean","connectAndSubscribe","connectWS","ws","subscribeWS","onmessage","res","onclose","readyState","closeWS","close","Promise","resolve","reject","WebSocket","wsss","WS","param","method","params","send","create","headers","Authorization","Info","getSearchParams","URL","location","searchParams","ModalWrapper","SaveList","modalShow","setModalShow","setName","secret","setSecret","loading","setLoading","defaultName","onSubmit","preventDefault","form","alert","list","post","code","records","deletes","url","forEach","deleted","delete","keys","set","history","replaceState","title","writeURL","catch","message","finally","AMOUNT_SEPARATOR","LOCAL_ID_KEY","HeadWrapper","getIds","idsStored","hasNewFormat","match","parseInt","App","setEdit","idsArray","amountsArray","cryptoListData","refetchAPI","eventEmitter","emit","handleAddOrRemove","add","idsString","toString","newPrices","sort","a","b","Infinity","Add","some","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById","TimeInterval","ALL","useUpdateData","setData","getData","mappedData","entries","points","time","v","subscriber","subscribe","wsData","lastData","lastDataTime","unsubscribe","constructor","cbs","this","event","push","func"],"mappings":"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","file":"static/js/main.7bc9fe54.chunk.js","sourcesContent":["import styled, { keyframes } from \"styled-components\";\n\nconst spin = keyframes`\n    to {\n        transform: rotate(1turn);\n    }\n`;\n\nconst SpinnerWrapper = styled.span`\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-grow: 1;\n  > span {\n    border: 3px solid var(--border-color);\n    border-radius: 50%;\n    border-top-color: var(--text-color);\n    width: 1em;\n    height: 1em;\n    animation: ${spin} 1s linear 0s infinite;\n  }\n`;\n\nconst Spinner = () => {\n  return (\n    <SpinnerWrapper>\n      <span></span>\n    </SpinnerWrapper>\n  );\n};\n\nexport default Spinner;\n","import React, {useState} from \"react\";\n\ntype Periods = \"1D\" | \"7D\" | \"1M\" | \"1Y\" | \"ALL\";\n\nexport const GlobalContext = React.createContext<{\n  period: Periods;\n  setPeriod: React.Dispatch<React.SetStateAction<Periods>>;\n}>({\n  period: \"1D\",\n  setPeriod: () => void 0\n});\n\nexport const GlobalContextProvider: React.FC = ({ children }) => {\n  const [period, setPeriod] = useState<Periods>(\"1D\");\n  return (\n    <GlobalContext.Provider\n      value={{\n        period,\n        setPeriod\n      }}\n    >\n      {children}\n    </GlobalContext.Provider>\n  );\n};\n","export const determineFraction = (num: number) => {\n  if (num >= 1) {\n    return Math.max(1, 4 - Math.floor(Math.log10(num)));\n  } else {\n    let count = -2;\n    // let num = 0.000001;\n    while (1 - num >= 0) {\n      num *= 10;\n      count += 1;\n    }\n    return Math.max(4, 4 + count);\n  }\n};\n\nexport const abbreviateNumber = (num: number) => {\n  if (num >= 1000000000) {\n    return removeTrailingZeros((num / 1000000000).toFixed(2)) + \"T\";\n  }\n  if (num >= 1000000) {\n    return removeTrailingZeros((num / 1000000).toFixed(2)) + \"M\";\n  }\n  if (num >= 1000) {\n    return removeTrailingZeros((num / 1000).toFixed(2)) + \"K\";\n  }\n  return num;\n};\n\nexport const removeTrailingZeros = (num: number | string) => {\n  return String(num).replace(/\\.?0+$/, \"\");\n};\n\nexport const priceFormatter = (price: number) => {\n  return removeTrailingZeros(price.toFixed(determineFraction(price)));\n};\n","import styled from \"styled-components\";\n\nexport const Wrapper = styled.div`\n  position: relative;\n  overflow: hidden;\n  display: inline-block;\n  /* margin-top: 8px; */\n  vertical-align: top;\n  /* display: inline-block; */\n  /* border-left: 1px solid #fff; */\n  /* border-radius: 4px; */\n  cursor: pointer;\n  box-sizing: border-box;\n  user-select: none;\n  white-space: nowrap;\n\n  button {\n    /* font-size: 0.8em; */\n    /* height: 80%; */\n  }\n\n  .buttons {\n    display: grid;\n    grid-auto-flow: column;\n    gap: 4px;\n    margin-left: 8px;\n    /* position: absolute; */\n    right: 0;\n    top: 0;\n    height: 100%;\n    z-index: 10;\n    background-color: var(--background-color);\n    /* transform: translateX(calc(101%)); */\n    transition: all 0.3s ease;\n    /* &.edit {\n      transform: none;\n    } */\n    /* overflow: hidden; */\n    /* > button {\n    } */\n    /* background: red; */\n  }\n`;\n\nexport const CellWrapper = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  /* &:hover {\n    transform: translateY(-2px);\n  } */\n  @media screen and (max-width: 450px) {\n    > a:first-child {\n      max-width: 45vw;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n  }\n\n  > span.metrics {\n    display: flex;\n    align-items: center;\n  }\n\n  > a {\n    color: inherit;\n    font-size: 1.1rem;\n    text-decoration: none;\n    font-weight: bold;\n\n    > span {\n      display: inline-flex;\n      flex-direction: column;\n      vertical-align: middle;\n\n      > span:nth-child(2) {\n        font-size: 0.8rem;\n        opacity: 0.5;\n      }\n    }\n  }\n\n  img {\n    width: 2rem;\n    margin-right: 0.5em;\n    vertical-align: middle;\n  }\n\n  span.price {\n    font-weight: bold;\n    font-size: 1.1rem;\n    transition: all 0.1s linear;\n    display: inline-flex;\n    flex-direction: column;\n    align-items: flex-end;\n    vertical-align: bottom;\n\n    &.up {\n      color: var(--up-color);\n    }\n\n    &.down {\n      color: var(--down-color);\n    }\n\n    > span:nth-child(2) {\n      font-size: 0.8rem;\n      opacity: 0.5;\n    }\n  }\n\n  span.percentage {\n    padding: 4px 8px;\n    border-radius: 4px;\n    color: #fff;\n    margin-left: 12px;\n    display: inline-block;\n    text-align: center;\n    /* width: 4.5em; */\n  }\n`;\n\nexport const MoreSection = styled.div`\n  /* border-bottom: 1px solid var(--border-color); */\n  justify-content: space-between;\n  display: flex;\n  position: relative;\n  overflow: hidden;\n  height: 300px;\n`;\n\nexport const ChartsWrapper = styled.div`\n  display: flex;\n  flex-grow: 1;\n  flex-direction: column;\n\n  .switch {\n    display: flex;\n    margin-right: 8px;\n\n    > span {\n      border: 1px solid transparent;\n      flex-grow: 1;\n      border-radius: 6px;\n      padding: 2px 4px;\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n\n      &.selected {\n        /* color: yellow; */\n        border-color: #1fe230;\n      }\n    }\n  }\n\n  img {\n    width: 100%;\n  }\n`;\n","import { createPortal } from \"react-dom\";\nimport styled from \"styled-components\";\n\nconst Wrapper = styled.div`\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  background: rgba(0, 0, 0, 0.8);\n  z-index: 10;\n  display: flex;\n\n  > div {\n    width: 80vw;\n    max-width: 500px;\n    padding: 24px;\n    margin: auto;\n    border-radius: 16px;\n    background: var(--gray-color);\n    @media screen and (max-width: 500px) {\n      width: 96vw;\n    }\n  }\n`;\n\nconst Modal: React.FC<{ show: boolean; onClose?: () => void }> = ({\n  children,\n  show,\n  onClose\n}) => {\n  return show\n    ? createPortal(\n        <Wrapper onClick={onClose}>\n          <div\n            onClick={e => {\n              e.stopPropagation();\n            }}\n          >\n            {children}\n          </div>\n        </Wrapper>,\n        document.body\n      )\n    : null;\n};\n\nexport default Modal;\n","import { IconCaretLeft, IconCaretRight, IconTrash } from \"@tabler/icons\";\nimport {\n  lazy,\n  memo,\n  Suspense,\n  useContext,\n  useEffect,\n  useMemo,\n  useRef,\n  useState\n} from \"react\";\n// import styled from \"styled-components\";\n// import ImgLoading from \"./components/ImgLoading\";\nimport Spinner from \"../components/Spinner\";\nimport { GlobalContext } from \"../context\";\nimport { abbreviateNumber, priceFormatter } from \"../utils/number\";\nimport { CellWrapper, ChartsWrapper, MoreSection, Wrapper } from \"./styled\";\nimport Modal from \"../components/modal\";\n\nconst LazyChart = lazy(() => import(\"../components/chart\"));\n\nconst ChartsGroup = memo<{\n  id?: number;\n  crypto?: string;\n}>(({ id = 1, crypto }) => {\n  const { period: globalPeriod, setPeriod: setGlobalPeriod } = useContext(\n    GlobalContext\n  );\n  const [period, setPeriod] = useState(globalPeriod);\n  useEffect(() => {\n    setGlobalPeriod(period);\n  }, [setGlobalPeriod, period]);\n  return (\n    <ChartsWrapper>\n      <div\n        style={{\n          marginBottom: 8,\n          textAlign: \"center\",\n          fontWeight: \"bold\"\n        }}\n      >\n        {crypto} Chart\n      </div>\n\n      <div className=\"switch\">\n        <span\n          className={period === \"1D\" ? \"selected\" : undefined}\n          onClick={() => setPeriod(\"1D\")}\n        >\n          24h\n        </span>\n        <span\n          className={period === \"7D\" ? \"selected\" : undefined}\n          onClick={() => setPeriod(\"7D\")}\n        >\n          7D\n        </span>\n        <span\n          className={period === \"1M\" ? \"selected\" : undefined}\n          onClick={() => setPeriod(\"1M\")}\n        >\n          1M\n        </span>\n        <span\n          className={period === \"1Y\" ? \"selected\" : undefined}\n          onClick={() => setPeriod(\"1Y\")}\n        >\n          1Y\n        </span>\n        <span\n          className={period === \"ALL\" ? \"selected\" : undefined}\n          onClick={() => setPeriod(\"ALL\")}\n        >\n          ALL\n        </span>\n      </div>\n      <Charts id={id} period={period} />\n    </ChartsWrapper>\n  );\n});\n\nconst Charts = ({ id = 1, period = \"1D\" }) => {\n  return (\n    <Suspense fallback={<Spinner />}>\n      <LazyChart id={id} period={period} />\n    </Suspense>\n  );\n};\n\nconst PriceCell = memo(\n  ({\n    name,\n    info,\n    onRemove,\n    prices,\n    setPrices,\n    idx,\n    expandStatus,\n    setExpandStatus,\n    edit\n  }: any) => {\n    const { id, p24h, price, slug, symbol, amount: propsAmount } = info;\n    const lastPrice = useRef(price);\n    const [isUp, setIsUp] = useState<1 | 0 | -1>(0);\n\n    const [amount, setAmount] = useState(propsAmount);\n\n    useEffect(() => {\n      if (\n        price !== lastPrice.current &&\n        price !== undefined &&\n        lastPrice.current !== undefined\n      ) {\n        if (lastPrice.current < price) {\n          setIsUp(1);\n        } else {\n          setIsUp(-1);\n        }\n        setTimeout(() => setIsUp(0), 1000);\n      }\n      lastPrice.current = price;\n    }, [price]);\n\n    const onMove = (isUp?: boolean) => {\n      const idxOffset = isUp ? -1 : 1;\n      const temp = prices[idx + idxOffset];\n      prices[idx + idxOffset] = prices[idx];\n      prices[idx] = temp;\n\n      setPrices([...prices]);\n    };\n\n    const isExpanded = !!expandStatus[id];\n\n    const priceDisplay = useMemo(() => {\n      return price ? priceFormatter(price) : \"-\";\n    }, [price]);\n\n    const onInput = (e: any) => {\n      if (!e) return;\n      const newAmount = Number(e.target.value);\n      setAmount(newAmount);\n      const elementIndex = prices.findIndex((token: any) => token.id === id);\n      if (elementIndex >= 0) {\n        prices[elementIndex] = {\n          ...prices[elementIndex],\n          amount: newAmount\n        };\n        setPrices([...prices]);\n      }\n    };\n\n    return (\n      <Wrapper>\n        <CellWrapper\n          key={id}\n          onClick={() => {\n            expandStatus[id] = !expandStatus[id];\n            setExpandStatus({ ...expandStatus });\n          }}\n        >\n          <a\n            href={`https://coinmarketcap.com/currencies/${slug}/`}\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            onClick={e => e.stopPropagation()}\n          >\n            <img\n              src={`https://s2.coinmarketcap.com/static/img/coins/64x64/${id}.png`}\n              alt={id}\n            />\n            <span>\n              <span>{name || symbol || \"unknown\"}</span>\n              {amount > 0 && <span>Balance: {abbreviateNumber(amount)}</span>}\n            </span>\n          </a>\n          {edit ? (\n            <div className={`buttons`} onClick={e => e.stopPropagation()}>\n              <input\n                placeholder=\"Balance\"\n                type={\"number\"}\n                value={amount}\n                onChange={onInput}\n                onKeyDown={e => {\n                  if (e.key === \"Enter\") {\n                    onInput(e);\n                  }\n                }}\n              ></input>\n              <button onClick={() => onMove(true)} disabled={idx === 0}>\n                <IconCaretLeft></IconCaretLeft>\n              </button>\n              <button\n                onClick={() => onMove()}\n                disabled={idx === prices.length - 1}\n              >\n                <IconCaretRight></IconCaretRight>\n              </button>\n              <button onClick={() => onRemove(id)} className=\"danger\">\n                <IconTrash></IconTrash>\n              </button>\n            </div>\n          ) : (\n            <span className=\"metrics\">\n              <span\n                className={`price ${\n                  isUp === 1 ? \"up\" : isUp === -1 ? \"down\" : \"\"\n                }`}\n              >\n                <span>${priceDisplay}</span>\n                {amount > 0 && !!price && (\n                  <span>${(price * amount).toFixed(2)}</span>\n                )}\n              </span>\n              <span\n                className=\"percentage\"\n                style={{\n                  backgroundColor:\n                    p24h > 0\n                      ? `rgba(0, 255, 0, ${Math.max(\n                          0.5,\n                          Math.sqrt(Math.abs(p24h / 20))\n                        )})`\n                      : `rgba(255, 0, 0, ${Math.max(\n                          0.5,\n                          Math.sqrt(Math.abs(p24h / 20))\n                        )})`\n                }}\n              >\n                {p24h ? `${p24h.toFixed(2)}%` : \"\"}\n              </span>\n            </span>\n          )}\n        </CellWrapper>\n\n        <Modal\n          show={isExpanded}\n          onClose={() => {\n            expandStatus[id] = false;\n            setExpandStatus({ ...expandStatus });\n          }}\n        >\n          <MoreSection>\n            <ChartsGroup id={id} crypto={name || symbol} />\n          </MoreSection>\n        </Modal>\n      </Wrapper>\n    );\n  }\n);\n\nexport default PriceCell;\n","import styled from \"styled-components\";\n\n// const;\n\nconst Wrapper = styled.p`\n  position: fixed;\n  bottom: 0;\n  margin: 0px auto;\n  font-size: 0.8em;\n  padding: 8px;\n  width: 100%;\n  background-color: var(--background-color);\n  /* border-top: 1px solid var(--border-color); */\n  display: grid;\n  grid-auto-flow: column;\n  grid-template-columns: 1fr 1fr;\n  align-items: center;\n  transition: all 0.3s ease-in-out, transform 0.3s linear 3s;\n\n  backdrop-filter: blur(6px);\n  a {\n    color: var(--text-color);\n    color: inherit;\n  }\n\n  &.Connecting {\n    background-color: yellow;\n    color: #000;\n  }\n  &.Connected {\n    background-color: rgba(0, 255, 0, 0.33);\n    transform: translateY(calc(100% - 4px));\n  }\n  &.Disconnected {\n    background-color: var(--down-color);\n  }\n  > *:first-child {\n    justify-self: start;\n  }\n  > *:last-child {\n    justify-self: end;\n  }\n`;\n\nconst Footer = ({\n  wsStatus,\n  lastRefetch,\n  reconnect,\n}: // reconnect,\n{\n  wsStatus: number;\n  lastRefetch: Date;\n  reconnect: any;\n}) => {\n  const status = wsStatus;\n  //   console.log(status);\n  const statusString =\n    status === 0 || status === undefined\n      ? \"Connecting\"\n      : status === 1\n      ? \"Connected\"\n      : status === 3\n      ? \"Disconnected\"\n      : undefined;\n  return (\n    <Wrapper className={statusString}>\n      <span>\n        <i>\n          {((+new Date() - Number(lastRefetch)) / 1000).toFixed(0) +\n            \" Seconds ago\"}\n        </i>\n      </span>\n      <span>\n        <i>{statusString}</i>\n        {status === 3 && <button onClick={reconnect}>Reconnect</button>}\n      </span>\n    </Wrapper>\n  );\n};\n\nexport default Footer;\n","import { useRef, useState } from \"react\";\nimport styled from \"styled-components\";\nimport { IconPlus } from \"@tabler/icons\";\nimport Modal from \"./components/modal\";\n\nconst TokenList = styled.div`\n  cursor: pointer;\n  margin: 4px auto;\n\n  > img {\n    width: 1.5em;\n    margin-right: 0.5em;\n    vertical-align: middle;\n  }\n`;\n\nconst Result = styled.div`\n  width: 100%;\n  border-radius: 4px;\n  text-align: left;\n  padding-left: 8px;\n  z-index: 10;\n  max-height: calc(100vh - 150px);\n  overflow: scroll;\n`;\n\nconst AddBtn = styled.div`\n  border-radius: 8px;\n  background: var(--gray-color);\n  text-align: center;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 4px;\n\n  &:hover {\n    filter: brightness(0.95);\n  }\n`;\n\nconst AddToken = ({ onAdd, mapData }: any) => {\n  const [search, setSearch] = useState(\"\");\n  const mapArr = Object.values(mapData);\n  const ref = useRef<HTMLInputElement>(null);\n  const [open, setOpen] = useState(false);\n\n  // useEffect(() => {\n  //   ref.current?.focus();\n  // }, []);\n\n  const searchRes = search\n    ? mapArr.filter(\n        (token: any) =>\n          token.name.toLowerCase().includes(search.toLowerCase()) ||\n          token.symbol.toLowerCase().includes(search.toLowerCase())\n      )\n    : [];\n  return (\n    <>\n      <AddBtn\n        onClick={() => {\n          setOpen(true);\n          setTimeout(() => {\n            ref.current?.focus();\n          }, 500);\n        }}\n      >\n        <IconPlus></IconPlus>\n      </AddBtn>\n      <Modal\n        show={open}\n        onClose={() => {\n          setOpen(false);\n          setSearch(\"\");\n        }}\n      >\n        <input\n          value={search}\n          onChange={e => setSearch(e.target.value)}\n          placeholder={mapArr.length ? \"Try 'Bitcoin'\" : \"Loading...\"}\n          disabled={!mapArr.length}\n          ref={ref}\n          className=\"crypto-search\"\n          style={{\n            padding: \"8px\"\n          }}\n        />\n        {searchRes.length ? (\n          <Result className={\"result\"}>\n            {searchRes.slice(0, 100).map((r: any) => (\n              <TokenList\n                key={r.id}\n                onClick={() => {\n                  onAdd(r.id);\n                  setSearch(\"\");\n\n                  setOpen(false);\n                }}\n              >\n                <img\n                  src={`https://s2.coinmarketcap.com/static/img/coins/64x64/${r.id}.png`}\n                  alt={r.id}\n                />\n                {r.name}\n              </TokenList>\n            ))}\n          </Result>\n        ) : null}\n      </Modal>\n    </>\n  );\n};\n\nexport default AddToken;\n","import axios from \"axios\";\nimport { useEffect, useState } from \"react\";\nimport { APIHost } from \"../components/useUpdateData\";\n\nconst useGetListings = (\n  ids: number[],\n  setter: React.Dispatch<\n    React.SetStateAction<\n      {\n        id: number;\n        price?: number | undefined;\n        p24h?: number | undefined;\n      }[]\n    >\n  >\n  // refetch: boolean\n): [() => Promise<any>, Date] => {\n  // console.log(refetch);\n\n  const [lastRefetch, setLastRefetch] = useState(new Date());\n\n  const refetch = () =>\n    axios\n      .get(\n        `${APIHost}/api/proxy/crypto-watch/data-api/v3/cryptocurrency/listing?ids=${ids.join(\n          \",\"\n        )}&aux=ath`\n      )\n      .then(({ data }) => {\n        if (!data?.data) return;\n        const priceData = data.data.cryptoCurrencyList;\n        setLastRefetch(new Date());\n        setter((data) => {\n          return data.map((d) => {\n            const find = priceData.find((p: any) => p.id === d.id);\n            // console.log(find);\n            // console.log(d.id);\n            if (find) {\n              return {\n                ...d,\n                price: find.quotes?.[0]?.price || 0,\n                p24h: find.quotes?.[0]?.percentChange24h || 0,\n                name: find.name,\n                slug: find.slug,\n              };\n            } else {\n              return d;\n            }\n          });\n        });\n      });\n  useEffect(() => {\n    if (!ids.length) return;\n    refetch();\n  }, [ids.length, setter]);\n  return [refetch, lastRefetch];\n};\n\nexport default useGetListings;\n","import axios from \"axios\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport { APIHost } from \"../components/useUpdateData\";\n\nconst useGetMapStorage = (key: string) => {\n  const [mapData, setMapData] = useState<any>(() =>\n    localStorage.getItem(key)\n      ? JSON.parse(String(localStorage.getItem(key))).data\n      : {}\n  );\n  const fetchMap = useCallback(\n    () =>\n      axios\n        .get(\n          `${APIHost}/api/proxy/crypto-watch/data-api/v3/map/all?cryptoAux=status&limit=10000&listing_status=active&start=1`\n        )\n        .then(({ data }) => {\n          const storedData = data.data.cryptoCurrencyMap.reduce(\n            (prev: any, next: any) => {\n              prev[next.id] = next;\n              return prev;\n            },\n            {}\n          );\n          // console.log(storedData);\n          setMapData(storedData);\n          localStorage.setItem(\n            key,\n            JSON.stringify({\n              data: storedData,\n              timeStamp: +new Date(),\n            })\n          );\n        }),\n    [key]\n  );\n  useEffect(() => {\n    if (localStorage.getItem(key)) {\n      const timeStamp = JSON.parse(String(localStorage.getItem(key))).timeStamp;\n      if (timeStamp + 1000 * 3600 * 24 <= Number(new Date())) {\n        console.log(\"refetch!\");\n        fetchMap();\n      }\n    } else {\n      console.log(\"init fetch!\");\n      fetchMap();\n    }\n  }, [fetchMap, key]);\n  return mapData;\n};\n\nexport default useGetMapStorage;\n","import { useEffect, useRef } from \"react\";\n\nconst useSubsequentUpdate = (cb: any, deps: string) => {\n  const mounted = useRef(false);\n  useEffect(() => {\n    if (!mounted.current) {\n      mounted.current = true;\n      return;\n    }\n    cb();\n  }, [deps]);\n};\n\nexport default useSubsequentUpdate;\n","import { useState, useEffect } from 'react';\n\nfunction useDebounce(value: string, delay: number) {\n  // 设置一个内部状态来存储防抖后的值\n  const [debouncedValue, setDebouncedValue] = useState(value);\n\n  useEffect(() => {\n    // 设置一个延时器\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    // 清除上一个延时器\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]); // 仅在value或delay变化时重新运行\n\n  return debouncedValue;\n}\n\nexport default useDebounce;","import { useEffect, useState } from \"react\";\n\nfunction usePageFocus(callback: (isFocused: boolean) => void) {\n  const [isFocused, setIsFocused] = useState(document.hasFocus());\n\n  useEffect(() => {\n    // 当页面获得或失去焦点时的处理函数\n    const handleFocusChange = () => {\n      const currentFocus = document.hasFocus();\n      setIsFocused(currentFocus);\n      callback(currentFocus);\n    };\n\n    // 绑定事件监听器\n    window.addEventListener(\"focus\", handleFocusChange);\n    window.addEventListener(\"blur\", handleFocusChange);\n\n    // 组件卸载时移除事件监听器\n    return () => {\n      window.removeEventListener(\"focus\", handleFocusChange);\n      window.removeEventListener(\"blur\", handleFocusChange);\n    };\n  }, [callback]); // 将 callback 添加到依赖数组中\n\n  return isFocused;\n}\n\nexport default usePageFocus;\n","import { useEffect, useRef, useState } from \"react\";\nimport useDebounce from \"./useDebounce\";\nimport usePageFocus from \"./usePageFocus\";\n\nconst useWbSocket = ({\n  onClose,\n  onMessage,\n  ids\n}: {\n  onClose: any;\n  onMessage: any;\n  ids: number[];\n}) => {\n  const [wsStatus, setWSStatus] = useState<number>(0);\n  const WSInstance = useRef<WebSocket>();\n  const debouncedIds = useDebounce(ids.join(\",\"), 5000)\n    .split(\",\")\n    .filter(Boolean)\n    .map(Number);\n  // const resubscribing = useRef(false);\n\n  // console.log(ids, debouncedIds);\n\n  const connectAndSubscribe = () => {\n    connectWS().then(ws => {\n      subscribeWS(debouncedIds);\n      ws.onmessage = function(res) {\n        onMessage?.(res);\n      };\n      ws.onclose = e => {\n        console.log(\"ws closed!\");\n        onClose?.();\n        setWSStatus(ws.readyState);\n        setTimeout(() => {\n          connectAndSubscribe();\n        }, 3000);\n      };\n    });\n  };\n\n  useEffect(() => {\n    if (debouncedIds.length) {\n      closeWS();\n      connectAndSubscribe();\n    }\n  }, [debouncedIds.length]);\n\n  /**\n   * close websocket connection actively\n   */\n  const closeWS = () => {\n    if (!WSInstance.current) return;\n    // @ts-ignore\n    if (WSInstance.current?.onclose) {\n      WSInstance.current.onclose = null;\n    }\n    WSInstance.current.close();\n  };\n\n  const connectWS: () => Promise<WebSocket> = () => {\n    return new Promise((resolve, reject) => {\n      try {\n        console.log(\"connecting...\");\n        const ws = new WebSocket(\n          \"wss://push.coinmarketcap.com/ws?device=web&client_source=home_page\"\n        );\n        WSInstance.current = ws;\n        WSInstance.current.addEventListener(\"open\", e => {\n          console.log(\"ws opened!\");\n          resolve(ws);\n        });\n\n        // @ts-ignore\n        window.wsss = WSInstance.current;\n        return WSInstance.current;\n      } catch (e) {\n        console.log(\"reconnecting...\");\n        setTimeout(() => {\n          connectWS().then(ws => {\n            resolve(ws);\n          });\n        }, 3000);\n      }\n    });\n  };\n\n  const subscribeWS = (ids: number[]) => {\n    if (!WSInstance.current) return;\n    const WS = WSInstance.current;\n    setWSStatus(WS.readyState);\n    const param = {\n      method: \"RSUBSCRIPTION\",\n      params: [\"main-site@crypto_price_5s@{}@normal\", ids.join(\",\")]\n    };\n    WS.send(JSON.stringify(param));\n  };\n\n  usePageFocus(isFocused => {\n    if (isFocused && WSInstance.current?.readyState === 3) {\n      connectAndSubscribe();\n    }\n  });\n\n  return [wsStatus, connectAndSubscribe] as const;\n};\n\nexport default useWbSocket;\n","import axios from \"axios\";\nimport styled from \"styled-components\";\n\nconst instance = axios.create({\n  headers: {\n    Authorization: `Bearer 5fcb77e68787da1467daeea55f0dd01a017efdf3`\n  }\n});\n\nconst Wrapper = styled.div`\n  display: flex;\n  justify-content: center;\n  padding: 8px;\n  /* position: absolute; */\n  /* bottom: 0.5em; */\n  width: 100%;\n  font-size: 0.8em;\n\n  a {\n    &:visited {\n      color: var(--text-color);\n    }\n  }\n\n  .export {\n    text-decoration: underline;\n  }\n`;\n\nconst Info = () => {\n  // const updateShortLink = () => {\n  //   instance\n  //     .patch(\"https://api-ssl.bitly.com/v4/bitlinks/bit.ly/3NOtY7t\", {\n  //       // long_url: window.location.href,\n  //       // link: \"https://blog.iccfish.com/2021/08/04/unlock-ssh-of-xiaomi-routers/\",\n  //       long_url: \"https://google.com\"\n  //     })\n  //     .then(({ data }) => {\n  //       navigator.clipboard.writeText(data.link).then(() => {\n  //         alert(\"Link Copied!\");\n  //       });\n  //     });\n  // };\n  // const getLink = () => {\n  //   instance.get(\"https://api-ssl.bitly.com/v4/bitlinks/bit.ly/3NCMPSD\");\n  // };\n  return (\n    <Wrapper className={\"info\"}>\n      <span>\n        Data Source:{\" \"}\n        <a href=\"https://coinmarketcap.com/\" target=\"_blank\" rel=\"noreferrer\">\n          CoinMarketCap\n        </a>\n      </span>\n      &nbsp;&nbsp;&nbsp;\n      <span>\n        <a\n          href=\"https://github.com/YueminHu/crypto_watch\"\n          target=\"_blank\"\n          rel=\"noreferrer\"\n        >\n          Github\n        </a>\n      </span>\n      {/* <span className='export' onClick={getLink}>\n        <button>Get</button>\n      </span> */}\n    </Wrapper>\n  );\n};\n\nexport default Info;\n","export const writeURL = (records: Record<string, any>, deletes?: string[]) => {\n  const url = new URL(window.location.href);\n  if (deletes) {\n    deletes.forEach((deleted) => url.searchParams.delete(deleted));\n  }\n  Object.keys(records).forEach((key) => {\n    url.searchParams.set(key, String(records[key]));\n  });\n  window.history.replaceState(\"\", document.title, url);\n};\n\nexport const getSearchParams = (key: string) => {\n  return new URL(window.location.href).searchParams.get(key);\n};\n","import { IconDeviceFloppy } from \"@tabler/icons\";\nimport axios from \"axios\";\nimport { useEffect, useState } from \"react\";\nimport styled from \"styled-components\";\nimport Modal from \"./components/modal\";\nimport { APIHost } from \"./components/useUpdateData\";\nimport { getSearchParams, writeURL } from \"./utils/dom\";\nimport Spinner from \"./components/Spinner\";\n\nconst ModalWrapper = styled.div`\n  form > p:last-child {\n    display: flex;\n    justify-content: space-between;\n  }\n`;\n\nconst SaveList: React.FC<{ prices: any }> = ({ prices }) => {\n  // const s = useMutation\n\n  const [modalShow, setModalShow] = useState(false);\n\n  const [name, setName] = useState(\"\");\n  const [secret, setSecret] = useState(\"\");\n\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    const defaultName = getSearchParams(\"name\");\n    if (defaultName) {\n      setName(defaultName);\n    }\n  }, []);\n\n  const onClickSave = (e: any) => {\n    e.preventDefault();\n    // console.log(e.target);\n    const form = e.target;\n    const name = form.name.value;\n    const secret = form.secret.value;\n    // const hasIds = new URL(window.location.href).searchParams.get(\"ids\");\n    /**\n     * has id\n     */\n    // console.log(prices);\n    if (!name) {\n      return alert(\"name is required!\");\n    }\n    const data = {\n      name,\n      secret,\n      list: prices.map((price: any) => ({\n        id: price.id,\n        amount: price.amount ? price.amount : undefined\n      }))\n    };\n    setLoading(true);\n    axios\n      .post(`${APIHost}/api/v1/crypto-watch-name`, data)\n      .then(d => {\n        //   console.log(d.data);\n        if (d.data.status.code === 0) {\n          writeURL({ name: data.name }, [\"ids\"]);\n          setModalShow(false);\n        }\n        alert(\"status: \" + d.data.status.code);\n      })\n      .catch(e => {\n        alert(e.message);\n      })\n      .finally(() => {\n        setLoading(false);\n      });\n  };\n  return (\n    <>\n      <button\n        onClick={() => {\n          setModalShow(true);\n        }}\n      >\n        <IconDeviceFloppy></IconDeviceFloppy>Save\n      </button>\n      <Modal show={modalShow}>\n        <ModalWrapper>\n          <form onSubmit={onClickSave}>\n            <p>\n              <input\n                type=\"text\"\n                placeholder=\"name...\"\n                name=\"name\"\n                value={name}\n                onChange={e => setName(e.target.value)}\n              />\n            </p>\n            <p>\n              <input\n                type=\"text\"\n                placeholder=\"secret...\"\n                name=\"secret\"\n                value={secret}\n                onChange={e => setSecret(e.target.value)}\n              />\n            </p>\n            <p>\n              <button onClick={() => setModalShow(false)}>Cancel</button>\n              <button type=\"submit\" disabled={loading}>\n                {loading ? <Spinner></Spinner> : \"Save\"}\n              </button>\n            </p>\n          </form>\n        </ModalWrapper>\n      </Modal>\n    </>\n  );\n};\n\nexport default SaveList;\n","import { useEffect, useState } from \"react\";\n\nimport styled from \"styled-components\";\nimport PriceCell from \"./Cell\";\nimport Status from \"./Footer\";\nimport AddToken from \"./Add\";\nimport { GlobalContextProvider } from \"./context\";\nimport useGetListings from \"./hooks/useGetListings\";\nimport useGetMapStorage from \"./hooks/useGetMapStorage\";\nimport useSubsequentUpdate from \"./hooks/useSubsequentUpdate\";\nimport useWbSocket from \"./hooks/useWebSocket\";\nimport Info from \"./Info\";\nimport eventEmitter from \"./utils/eventEmitter\";\nimport {\n  IconEdit,\n  IconFold,\n  IconSortDescending,\n  IconSortDescendingNumbers\n} from \"@tabler/icons\";\nimport SaveList from \"./saveList\";\nimport { getSearchParams } from \"./utils/dom\";\nimport axios from \"axios\";\nimport { APIHost } from \"./components/useUpdateData\";\n\nconst ID_SEPARATOR = \"_\";\nconst AMOUNT_SEPARATOR = \"-\";\n\nconst LOCAL_KEY = \"LOCAL_KEY\";\nconst LOCAL_ID_KEY = \"LOCAL_ID_KEY\";\n\nconst Wrapper = styled.div`\n  text-align: left;\n  padding: 0px 8px;\n  display: grid;\n  --columns-count: 3;\n  grid-template-columns: repeat(var(--columns-count), 1fr);\n  gap: 8px;\n  @media screen and (min-width: 1200px) {\n    --columns-count: 4;\n  }\n  @media screen and (min-width: 551px) and (max-width: 850px) {\n    --columns-count: 2;\n  }\n  @media screen and (max-width: 550px) {\n    --columns-count: 1;\n  }\n`;\n\nconst HeadWrapper = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: sticky;\n  padding: 8px;\n  /* top: 0; */\n  background-image: linear-gradient(\n    to bottom,\n    var(--background-color) 0%,\n    var(--background-color) 70%,\n    transparent 100%\n  );\n  top: -1px;\n  z-index: 10;\n  @media screen and (max-width: 450px) {\n    flex-direction: column;\n    /* overflow: hidden; */\n  }\n\n  > div:first-child {\n    flex-grow: 1;\n  }\n\n  > p.buttons {\n    white-space: nowrap;\n    width: 100%;\n    overflow: scroll;\n    padding: 4px 8px;\n    margin: 0px;\n  }\n`;\n\nconst Guide = styled.div`\n  text-align: center;\n  cursor: pointer;\n  margin: 32px auto;\n  font-weight: bold;\n`;\n\nconst getIds = () => {\n  const url = new URL(window.location.href);\n\n  if (url.searchParams.get(\"name\")) {\n    return [];\n  }\n\n  const idsStored =\n    localStorage.getItem(LOCAL_ID_KEY) || url.searchParams.get(\"ids\") || \"\";\n\n  const hasNewFormat = idsStored.match(/[a-z]/);\n\n  return idsStored\n    ? idsStored.split(ID_SEPARATOR).map(id => ({\n        id: id.includes(AMOUNT_SEPARATOR)\n          ? parseInt(id.split(AMOUNT_SEPARATOR)[0], hasNewFormat ? 36 : 10)\n          : parseInt(id, hasNewFormat ? 36 : 10) || 1,\n        amount: id.includes(AMOUNT_SEPARATOR)\n          ? Number(id.split(AMOUNT_SEPARATOR)[1])\n          : \"\"\n      }))\n    : [];\n};\n\nexport default function App() {\n  const [edit, setEdit] = useState(false);\n\n  const [prices, setPrices] = useState<\n    {\n      id: number;\n      price?: number;\n      p24h?: number;\n      slug?: string;\n      name?: string;\n      amount?: number | string;\n    }[]\n  >(getIds);\n\n  // console.log(prices)\n\n  const [expandStatus, setExpandStatus] = useState({});\n\n  const idsArray = prices.map(({ id }) => id);\n  const amountsArray = prices.map(({ amount }) => amount);\n\n  const cryptoListData = useGetMapStorage(LOCAL_KEY);\n\n  const [refetchAPI, lastRefetch] = useGetListings(idsArray, setPrices);\n\n  const [wsStatus, reconnect] = useWbSocket({\n    ids: idsArray,\n    onClose: () => refetchAPI(),\n    onMessage: (res: any) => {\n      const data = JSON.parse(res.data);\n      if (data?.d) {\n        const info = data.d;\n        // console.log(info);\n        eventEmitter.emit(`WS-${info.id}`, info);\n        setPrices(prices => {\n          return prices.map(p => {\n            if (p.id === info.id) {\n              return {\n                ...info,\n                ...p,\n                price: info.p,\n                p24h: info.p24h\n              };\n            }\n            return p;\n          });\n        });\n      } else {\n        console.log(data);\n      }\n    }\n  });\n\n  const handleAddOrRemove = (id: number, add?: boolean) => {\n    if (idsArray.includes(id) && add) {\n      return;\n    }\n    setPrices(prices => {\n      const newPrices = add\n        ? [\n            {\n              id: id\n            },\n            ...prices\n          ]\n        : prices.filter(price => price.id !== id);\n      return newPrices;\n    });\n    // setExpandStatus({\n    //   ...expandStatus,\n    //   [id]: false,\n    // });\n  };\n\n  // const handleCollapse = (expand?: boolean) => {\n  //   if (!expand) {\n  //     setExpandStatus({});\n  //   }\n  // };\n\n  useEffect(() => {\n    const name = getSearchParams(\"name\");\n    if (name) {\n      axios.get(`${APIHost}/api/v1/crypto-watch-name?name=${name}`).then(d => {\n        if (d.data.data) {\n          setPrices(d.data.data);\n        }\n      });\n    }\n  }, []);\n\n  /**\n   * rewrite URL when id length / order changes\n   */\n  useSubsequentUpdate(() => {\n    const idsString = idsArray\n      .map((id, idx) => {\n        return (\n          id.toString(36) +\n          (amountsArray[idx] ? `${AMOUNT_SEPARATOR}${amountsArray[idx]}` : \"\")\n        );\n      })\n      .join(ID_SEPARATOR);\n    // writeURL(idsString);\n    localStorage.setItem(LOCAL_ID_KEY, idsString);\n  }, idsArray.join() + amountsArray.join());\n\n  return (\n    <GlobalContextProvider>\n      <div className=\"App\">\n        <HeadWrapper>\n          <p className=\"buttons\">\n            <button\n              onClick={() => {\n                const newPrices = [...prices];\n                newPrices.sort((a, b) =>\n                  a.amount &&\n                  a.price &&\n                  b.price &&\n                  b.amount &&\n                  typeof a.amount === \"number\" &&\n                  typeof b.amount === \"number\"\n                    ? b.amount * b.price - a.amount * a.price\n                    : -Infinity\n                );\n                setPrices(newPrices);\n              }}\n            >\n              <IconSortDescendingNumbers></IconSortDescendingNumbers>\n              Sort Value\n            </button>\n            &nbsp;\n            <button\n              onClick={() => {\n                const newPrices = [...prices];\n                newPrices.sort((a, b) =>\n                  a.p24h && b.p24h ? b.p24h - a.p24h : Infinity\n                );\n                setPrices(newPrices);\n              }}\n            >\n              <IconSortDescending></IconSortDescending>\n              Sort Change\n            </button>\n            &nbsp;\n            <button onClick={() => setExpandStatus({})}>\n              <IconFold></IconFold>\n              Fold All\n            </button>\n            &nbsp;\n            <button onClick={() => setEdit(!edit)}>\n              <IconEdit></IconEdit>\n              {edit ? \"Done\" : \"Edit\"}\n            </button>\n            &nbsp;\n            <SaveList prices={prices}></SaveList>\n          </p>\n        </HeadWrapper>\n        <Wrapper>\n          {prices.length\n            ? prices.map((info: any, idx) => (\n                <PriceCell\n                  name={cryptoListData[info.id]?.symbol}\n                  key={info.id}\n                  info={info}\n                  onRemove={(id: number) => handleAddOrRemove(id)}\n                  prices={prices}\n                  setPrices={setPrices}\n                  idx={idx}\n                  expandStatus={expandStatus}\n                  setExpandStatus={setExpandStatus}\n                  edit={edit}\n                />\n              ))\n            : null}\n          <AddToken\n            onAdd={(id: number) => handleAddOrRemove(id, true)}\n            mapData={cryptoListData}\n          />\n        </Wrapper>\n        {prices.some(price => !!price.amount) && (\n          <p>\n            Total Balance: $\n            <b>\n              {prices\n                .reduce((prev, next) => {\n                  return next.amount &&\n                    next.price &&\n                    typeof next.amount == \"number\"\n                    ? prev + next.amount * next.price\n                    : prev;\n                }, 0)\n                .toFixed(2)}\n            </b>\n          </p>\n        )}\n        <Info />\n\n        {idsArray.length ? (\n          <Status\n            wsStatus={wsStatus}\n            // wsInstance={WSInstance}\n            reconnect={reconnect}\n            lastRefetch={lastRefetch}\n          />\n        ) : null}\n      </div>\n    </GlobalContextProvider>\n  );\n}\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import axios from \"axios\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport eventEmitter from \"../utils/eventEmitter\";\n\nconst TimeInterval: any = {\n  \"1D\": 300,\n  \"7D\": 300,\n  \"1M\": 3600,\n  \"1Y\": 86400,\n  ALL: 86400\n};\n\nexport const APIHost =\n  process.env.NODE_ENV === \"production\"\n    ? \"https://yoomin.us\"\n    : \"https://yoomin.us\";\n\nconst useUpdateData = (id: number, period: string): [any[], boolean] => {\n  const [data, setData] = useState<any[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n\n  const getData = useCallback(() => {\n    // clear();\n    setLoading(true);\n    return axios\n      .get(\n        `${APIHost}/api/proxy/crypto-watch/data-api/v3/cryptocurrency/detail/chart?id=${id}&range=${period}`\n      )\n      .then(({ data }) => {\n        const mappedData = Object.entries<any>(data.data.points).map(\n          ([key, value]) => ({\n            time: Number(key),\n            value: value.v[0]\n          })\n        );\n        setData(mappedData);\n        return mappedData;\n      })\n      .catch(e => {\n        return [];\n      })\n      .finally(() => {\n        setLoading(false);\n      });\n\n    // return () => eventEmitter.unsubscribe(`WS-${id}`, subscriber);\n  }, [id, period]);\n\n  useEffect(() => {\n    getData();\n    const subscriber = eventEmitter.subscribe(`WS-${id}`, (wsData: any) => {\n      setData(data => {\n        if (!data.length) return data;\n        const lastData = data[data.length - 1];\n        const lastDataTime = lastData.time * 1000;\n        const now = Number(new Date());\n        const shouldInsertNewData = TimeInterval[period] * 1000;\n        // console.log(now, lastDataTime, shouldInsertNewData);\n        if (now - lastDataTime >= shouldInsertNewData) {\n          // console.log(\"insert new line!\");\n          return [\n            ...data,\n            {\n              time: Math.floor(Number(new Date()) / 1000),\n              value: wsData.p\n            }\n          ];\n        } else {\n          // lastData.time = now\n          // console.log(\"in-place update!\");\n          lastData.value = wsData.p;\n          return [...data];\n        }\n        // console.log(lastDataTime);\n        // // console.log(data);\n        // return data;\n      });\n    });\n    return () => {\n      console.log(\"unsubscribe!\");\n      eventEmitter.unsubscribe(`WS-${id}`, subscriber);\n    };\n  }, [id, period, getData]);\n\n  return [data, loading];\n};\n\nexport default useUpdateData;\n","type Events = string;\n\nclass EventEmitter {\n  cbs: {\n    [key: string]: any[];\n  };\n  constructor() {\n    this.cbs = {};\n  }\n  subscribe(event: Events, cb: any) {\n    if (!this.cbs[event]) {\n      this.cbs[event] = [];\n    }\n    this.cbs[event].push(cb);\n    return cb;\n    // this.cbs.push(cb);\n  }\n  unsubscribe(event: Events, cb: any) {\n    if (this.cbs[event]) {\n      this.cbs[event] = this.cbs[event].filter((func) => func !== cb);\n      if (this.cbs[event].length === 0) {\n        delete this.cbs[event];\n      }\n    }\n  }\n  emit(event: Events, data: any) {\n    if (this.cbs[event]) {\n      this.cbs[event].forEach((cb) => cb(data));\n    }\n  }\n}\n\nexport default new EventEmitter();\n"],"sourceRoot":""}